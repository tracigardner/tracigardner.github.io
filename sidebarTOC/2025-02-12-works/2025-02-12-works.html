<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* TOC for Sidebar */
        .TOCsidebar {
            width: 250px;
            background-color: #f8f9fa;
            border: 1px solid #aaaaaa;
            border-radius: 4px;
            padding: 10px;
        }

        .TOCsidebar h2 {
            margin-top: 0px;
            margin-left: 0px;
        }

        .TOCsidebar ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        .TOCsidebar li {
            margin: 5px 0;
        }

        .TOCsidebar a {
            text-decoration: none;
            color: #333;
            display: block;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .TOCsidebar a:hover {
            background-color: #861f41;
            color: #ffffff;
        }

        .TOCsidebar a.TOCcurrent {
            background-color: #861f41;
            color: white;
        }

        .TOCchapter {
            cursor: pointer;
            font-weight: bold;
            margin: 5px 0;
        }

        .TOCchapter span {
            display: block;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .TOCchapter.TOCopen span {
            background-color: #ddd;
        }

        .TOCchapter ul {
            display: none;
            padding-left: 15px;
        }

        .TOCchapter.TOCopen ul {
            display: block;
        }

        /*       play: block;
        } */
    </style>
    <title>Document</title>
</head>

<body>
    <h1>sidebar code</h1>
    <div class="TOCsidebar">
        <h2>Chapters</h2>
        <ul>
            <li class="TOCchapter">
                <span>Foundational Concepts</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/foundational-concepts/sample-page/">What Is Technical Communication?</a></li>
                    <li><a href="https://tsc.tracigardner.com/foundational-concepts/the-rhetorical-situation/">The Rhetorical Situation</a></li>
                    <li><a href="#">Topic 3</a></li>
                </ul>
            </li>
            <li class="TOCchapter">
                <span>Correspondence</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/correspondence/">Correspondence Overview</a></li>
                    <li><a href="https://tsc.tracigardner.com/correspondence/letter-components/">Letter Components</a></li>
                    <li><a href="https://tsc.tracigardner.com/correspondence/memo-components/">Memo Components</a></li>
                    <li><a href="https://tsc.tracigardner.com/correspondence/email-components/">Email Components</a></li>
                </ul>
            </li>
            <li class="TOCchapter">
                <span>Document Design</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/document-design-overview/">Document Design Overview</a></li>
                    <li><a href="https://tsc.tracigardner.com/document-design-overview/crap-principles/">CRAP Principles</a></li>
                    <li><a href="https://tsc.tracigardner.com/document-design-overview/making-captivating-charts-and-graphs/">Making Captivating Charts and Graphs</a></li>
                    <li><a href="https://tsc.tracigardner.com/document-design-overview/more-design-principles/">More Design Principles</a></li>
                </ul>
            </li>

            <li class="TOCchapter">
                <span>Ethics</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/ethics/">Ethics Overview</a></li>
                    <li><a href="https://tsc.tracigardner.com/ethics/analyzing-stakeholders/">Analyzing Stakeholders</a></li>
                    <li><a href="https://tsc.tracigardner.com/ethics/conclusion/">Conclusion</a></li>
                    <li><a href="https://tsc.tracigardner.com/ethics/general-guidelines/">General Guidelines</a></li>
                    <li><a href="https://tsc.tracigardner.com/ethics/professional-codes-of-ethics/">Professional Codes of Ethics</a></li>
                </ul>
            </li>

            <li class="TOCchapter">
                <span>Evidence</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/evidence/">Evidence Overview</a></li>
                    <li><a href="https://tsc.tracigardner.com/evidence/visual-evidence/">Visual Evidence</a></li>
                    <li><a href="https://tsc.tracigardner.com/evidence/written-evidence/">Written Evidence</a></li>
                    <li>Audio Evidence ???</li>
                </ul>
            </li>


            <li class="TOCchapter">
                <span>Informal Reports</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/informal-reports/">Informal Reports Overview</a></li>
                    <li><a href="https://tsc.tracigardner.com/informal-reports/characteristics/">Characteristics</a></li>
                    <li><a href="https://tsc.tracigardner.com/informal-reports/different-types/">Different Types</a></li>
                </ul>
            </li>

            <li class="TOCchapter">
                <span>Informational Articles</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/informational-articles/">Informational Articles Overview</a></li>
                    <li><a href="https://tsc.tracigardner.com/informational-articles/organizing-the-introduction/">Organizing the Introduction</a></li>
                    <li><a href="https://tsc.tracigardner.com/informational-articles/organizing-the-body/">Organizing the Body</a></li>
                    <li><a href="https://tsc.tracigardner.com/informational-articles/organizing-the-conclusion/">Organizing the Conclusion</a></li>
                </ul>
            </li>

            <li class="TOCchapter">
                <span>Project Collaboration</span>
                <ul>
                    <li><a href="#">Setting Up Group Contracts</a></li>
                    <li><a href="#">Organizing Group Meetings</a></li>
                    <li><a href="#">Managing Group Communication</a></li>
                    <li><a href="#">Handling Difficult Situations</a></li>
                </ul>
            </li>

            <li class="TOCchapter">
                <span>Back Matter</span>
                <ul>
                    <li><a href="https://tsc.tracigardner.com/glossary/">Glossary</a></li>
                    <li><a href="#">Index?</a></li>
                    <li><a href="#">Colophon?</a></li>
                </ul>
            </li>
        </ul>

    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const chapters = document.querySelectorAll(".TOCchapter span");

            // Toggle chapters on click and store in localStorage
            chapters.forEach((chapterSpan) => {
                chapterSpan.addEventListener("click", function () {
                    const parentChapter = this.parentElement;
                    parentChapter.classList.toggle("TOCopen");

                    // Store state in localStorage
                    if (parentChapter.classList.contains("TOCopen")) {
                        localStorage.setItem("openChapter", parentChapter.dataset.chapter);
                    } else {
                        localStorage.removeItem("openChapter");
                    }
                });
            });

            // Retrieve open chapter from localStorage
            const openChapter = localStorage.getItem("openChapter");
            if (openChapter) {
                const chapterToOpen = document.querySelector(`.TOCchapter[data-chapter="${openChapter}"]`);
                if (chapterToOpen) {
                    chapterToOpen.classList.add("TOCopen");
                }
            }

            // Normalize URL function to remove trailing slashes
            function normalizeURL(url) {
                return url.replace(/\/$/, ""); // Removes trailing slash
            }

            // Highlight the current page in the sidebar
            const links = document.querySelectorAll(".TOCsidebar a");
            const currentPage = normalizeURL(window.location.href.split("#")[0]); // Strip anchor ID and normalize

            console.log("Current Page:", currentPage); // Debugging URL matching

            links.forEach((link) => {
                if (normalizeURL(link.href) === currentPage) {
                    link.classList.add("TOCcurrent");
                    console.log("Matched link:", link.href); // Debugging matched link

                    // Open the corresponding chapter
                    const parentChapter = link.closest(".TOCchapter");
                    if (parentChapter) {
                        parentChapter.classList.add("TOCopen");
                        localStorage.setItem("openChapter", parentChapter.dataset.chapter); // Store it
                    }
                }
            });
        });
    </script>
</body>

</html>